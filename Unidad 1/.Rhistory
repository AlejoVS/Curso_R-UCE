packages <- c('tidyverse','ggplot2','visdat','caret','recipes',
'mice','Hmisc','DMwR')
libraries(packages)
data(algae)
glimpse(algae)
sum(is.na(algae))
algae %>%
is.na() %>%
reshape2::melt()
algae %>%
is.na() %>%
reshape2::melt() %>%
ggplot(aes(Var2, Var1, fill=value))
algae %>%
is.na() %>%
reshape2::melt() %>%
ggplot(aes(Var2, Var1, fill=value)) +
geom_raster()
algae %>%
is.na() %>%
reshape2::melt() %>%
ggplot(aes(Var2, Var1, fill=value)) +
geom_raster() +
coord_flip()
algae %>%
is.na() %>%
reshape2::melt() %>%
ggplot(aes(Var2, Var1, fill=value)) +
geom_raster() +
coord_flip() +
scale_y_continuous(NULL, expand = c(0, 0))
algae %>%
is.na() %>%
reshape2::melt() %>%
ggplot(aes(Var2, Var1, fill=value)) +
geom_raster() +
coord_flip() +
scale_y_continuous(NULL, expand = c(0, 0)) +
scale_fill_grey(name = "",
labels = c("Present",
"Missing"))
algae %>%
is.na() %>%
reshape2::melt() %>%
ggplot(aes(Var2, Var1, fill=value)) +
geom_raster() +
coord_flip() +
scale_y_continuous(NULL, expand = c(0, 0)) +
scale_fill(name = "",
labels = c("Present",
"Missing")) +
xlab("Observation") +
theme(axis.text.y  = element_text(size = 4))
algae %>%
is.na() %>%
reshape2::melt() %>%
ggplot(aes(Var2, Var1, fill=value)) +
geom_raster() +
coord_flip() +
scale_y_continuous(NULL, expand = c(0, 0)) +
scale_fill_grey(name = "",
labels = c("Present",
"Missing")) +
xlab("Observación") +
theme(axis.text.y  = element_text(size = 10))
sapply(algae,function(x){sum(is.na(x))}) # número de NA´s en la columnas
round((apply(apply(X = algae,MARGIN = 2,FUN = is.na )
,2,sum)/nrow(algae))*100,2)
algae$Chla_mean <- impute(algae$Chla, mean)
View(algae)
algae$Chla_median <- impute(algae$Chla,'median')
which(is.na(algae$Chla))
algae <- select(Chla_mean,Chla) %>% filter(Chla==is.na())
algae$Chla_mean <- impute(algae$Chla, mean)
which(is.na(algae$Chla))
algae <- select(Chla_mean,Chla) %>% filter(Chla==is.na())
View(algae)
algae <- select(Chla,Chla_mean) %>% filter(Chla==is.na())
algae <- algae %>% select(Chla,Chla_mean) %>% filter(Chla==is.na())
algae %>% select(Chla,Chla_mean) %>% filter(Chla==is.na())
algae <- algae %>% select(Chla,Chla_mean) %>% filter(Chla==is.na(Chla))
algae %>% select(Chla,Chla_mean) %>% filter(Chla==is.na(Chla))
data(algae)
algae$Chla_mean <- impute(algae$Chla, mean)
which(is.na(algae$Chla))
algae <- algae %>% select(Chla,Chla_mean) %>% filter(Chla==is.na(Chla))
algae <- algae %>% select(Chla,Chla_mean) %>% is.na()
data(algae)
glimpse(algae)
algae$Chla_mean <- impute(algae$Chla, mean)
which(is.na(algae$Chla))
algae[56]
algae[56,]
algae$Chla_random <- impute(algae$Chla,'random')
algae[56,]
imputed_Data
imputed_Data <- mice(algae, m=5, maxit = 50, method = 'pmm', seed = 500)
browseURL(url = "http://openaccess.uoc.edu/webapps/o2/bitstream/10609/64085/6/romancalafatiTFG0617memoria.pdf",
browser = getOption("browser"))
browseURL(url = "http://openaccess.uoc.edu/webapps/o2/bitstream/10609/64085/6/romancalafatiTFG0617memoria.pdf",
browser = getOption("browser"))
# Solo variables numeric
numeric_cols <-names(Ozone)[sapply(Ozone, is.numeric)]
data (Ozone, package="mlbench")
glimpse(Ozone)
install.packages("esquisse")
esquisse:::esquisser()
ggplot(Ozone) +
aes(x = "", y = V13) +
geom_boxplot(fill = "#238b45") +
theme_void()
ggplot(Ozone) +
aes(x = V13) +
geom_boxplot(fill = "#238b45") +
theme_void()
ggplot(Ozone_Knn) +
aes(x = V13) +
geom_boxplot(fill = "#238b45") +
theme_void()
Ozone_knn<-knnImputation(outliers_missing)
outliers<-function(x){
IQR <- quantile(x, probs=c(.25, .75), na.rm = T)
H <- 1.5 * IQR(x, na.rm = T)
x[x < (IQR[1] - H)] <- NA
x[x > (IQR[2] + H)] <- NA
return(x)}
numeric_cols<-names(Ozone)[sapply(Ozone, is.numeric)]
numeric_data<-Ozone[,names(Ozone)%in% numeric_cols]
outliers_missing <-data.frame(sapply(numeric_data,outliers))
Ozone_knn<-knnImputation(outliers_missing)
ggplot(Ozone_knn) +
aes(x = V13) +
geom_boxplot(fill = "#238b45") +
theme_void()
ggplot(Ozone_knn) +
aes(x = V13,y="values") +
geom_boxplot(fill = "#238b45") +
theme_void()
ggplot(Ozone,aes(x=V13))+
geom_boxplot()
ggplot(Ozone_knn,aes(x=V13))+
geom_boxplot()
data(algae)
glimpse(algae)
# Eliminar las filas
data.cleaning <- algae[!is.na(algae),]
data(algae)
data(algae)
glimpse(algae)
# Eliminar las filas
data.cleaning <- algae[!is.na(algae$Chla),]
complete.cases(algae)
data.cleaning2 <- algae[complete.cases(algae,)]
data.cleaning2 <- algae[complete.cases(algae),]
### 1.1.2. Paquete mice
imp <- mice(algae,method = "mean",seed = 122,print=F)
imp
sapply(algae_mice,function(x){sum(is.na(x))})
sapply(imp,function(x){sum(is.na(x))})
# Paquete esquisse
library(esquisse)
esquisse:::esquisser()
esquisse:::esquisser()
# install.packages(shiny)
data("iris")
force(iris)
esquisse:::esquisser()
library(ggplot2)
ggplot(iris) +
aes(x = Species, y = Sepal.Width, fill = Species) +
geom_boxplot() +
scale_fill_brewer(palette = "PiYG") +
labs(x = "Especies", y = "Valores", caption = "Tamaño de sepalo según las especies de flores", fill = "ESPECIES") +
theme_bw() +
theme(legend.position = "top")
packages <- c('tidyverse','ggplot2','visdat','caret','recipes',
'mice','Hmisc','DMwR')
library(easypackages)
libraries(packages)
x <- c(1,2,5,8,9,NA)
is.na(x) # devuleve una respuesta de tipo buleana donde TRUE muestra la presencia de NA's
which(is.na(x)) # posición de los valores perdidos
data(algae)
glimpse(algae)
View(algae)
is.na(algae)
which(is.na(x))
which(is.na(algae))
sum(is.na(algae))
algae %>%
is.na()
View(algae)
algae %>%
is.na() %>%
reshape2::melt()
algae %>%
is.na() %>%
reshape2::melt() %>%
ggplot(aes(Var2, Var1, fill=value))
algae %>%
is.na() %>%
reshape2::melt() %>%
ggplot(aes(Var2, Var1, fill=value)) +
geom_raster()
algae %>%
is.na() %>%
reshape2::melt() %>%
ggplot(aes(Var2, Var1, fill=value)) +
geom_raster() +
coord_flip()
algae %>%
is.na() %>%
reshape2::melt() %>%
ggplot(aes(Var2, Var1, fill=value)) +
geom_raster() +
coord_flip() +
scale_y_continuous(NULL, expand = c(0, 0))
algae %>%
is.na() %>%
reshape2::melt() %>%
ggplot(aes(Var2, Var1, fill=value)) +
geom_raster() +
coord_flip() +
scale_y_continuous(NULL, expand = c(0, 0)) +
scale_fill_grey(name = "",
labels = c("Present",
"Missing"))
algae %>%
is.na() %>%
reshape2::melt() %>%
ggplot(aes(Var2, Var1, fill=value)) +
geom_raster() +
coord_flip() +
scale_y_continuous(NULL, expand = c(0, 0)) +
scale_fill_grey(name = "",
labels = c("Present",
"Missing")) +
labs(title = "Valores perdidos",
x="Observaciones",
y="Varibales")+
theme(axis.text.y  = element_text(size = 5))
theme(axis.text.y  = element_text(size = 10)
algae %>%
is.na() %>%
reshape2::melt() %>%
ggplot(aes(Var2, Var1, fill=value)) +
geom_raster() +
coord_flip() +
scale_y_continuous(NULL, expand = c(0, 0)) +
scale_fill_grey(name = "",
labels = c("Present",
"Missing")) +
labs(title = "Valores perdidos",
x="Observaciones",
y="Varibales")+
theme(axis.text.y  = element_text(size = 10))
algae %>%
is.na() %>%
reshape2::melt() %>%
ggplot(aes(Var2, Var1, fill=value)) +
geom_raster() +
coord_flip() +
scale_y_continuous(NULL, expand = c(0, 0)) +
scale_fill_grey(name = "",
labels = c("Present",
"Missing")) +
labs(title = "Valores perdidos",
x="Observaciones",
y="Varibales")+
theme(axis.text.y  = element_text(size = 10))
sapply(algae,function(x){sum(is.na(x))}) # número de NA´s en la columnas
(apply(apply(X = algae,MARGIN = 2,FUN = is.na )
,MARGIN=2,FUN=sum)
(apply(apply(X = algae,MARGIN = 2,FUN = is.na )
,MARGIN=2,FUN=sum))
lllll
apply(apply(X = algae,MARGIN = 2,FUN = is.na )
,MARGIN=2,FUN=sum))
apply(apply(X = algae,MARGIN = 2,FUN = is.na )
,MARGIN=2,FUN=sum)
,MARGIN=2,FUN=sum)/nrow(algae)
(apply(apply(X = algae,MARGIN = 2,FUN = is.na )
,MARGIN=2,FUN=sum)/nrow(algae))
round((apply(apply(X = algae,MARGIN = 2,FUN = is.na )
,MARGIN=2,FUN=sum)/nrow(algae))*100,2)
data.cleaning <- algae[!is.na(algae$Chla),]
complete.cases(algae)
data.cleaning2 <- algae[complete.cases(algae),]
data(algae)
glimpse(algae)
algae$Chla_mean <- impute(algae$Chla, mean)
mean(algae$Chla)
mean(algae$Chla,na.rm = T)
mean(algae$Chla)
mean(algae$Chla,na.rm = T)
algae$Chla_random <- impute(algae$Chla,'random')
median(algae$Chla,na.rm = T)
algae$Chla_random <- impute(algae$Chla,'random')
algae$Chla_median <- impute(algae$Chla,'median')
which(is.na(algae$Chla))
algae$Chla[56,]
algae$Chla[56,]
algae[56,]
algae$Chla_median <- impute(algae$Chla,median)
which(is.na(algae$Chla))
algae[56,]
imputed_Data <- mice(algae, m=5, maxit = 50, method = 'pmm', seed = 500)
summary(imputed_Data)
algae_mice <- complete(imputed_Data,2)
algae_mice <- complete(imputed_Data,3)
View(algae_mice)
sapply(algae_mice,function(x){sum(is.na(x))})
algae_mice[56,]
algae_mice[56,]
sapply(algae_mice,function(x){sum(is.na(x))})
algae_mice <- algae
algae_mice <- complete(imputed_Data,2)
sapply(algae_mice,function(x){sum(is.na(x))})
algae <- complete(imputed_Data,2)
sapply(algae_mice,function(x){sum(is.na(x))})
### 1.1.1. Paquete DWwR
algae_knn<-knnImputation(algae)
sapply(algae_mice,function(x){sum(is.na(x))})
data (Ozone, package="mlbench")
glimpse(Ozone)
sapply(Ozone,function(x){sum(is.na(x))})
x <- seq(1:100,1)
x <- seq(1,100,1)
IQR(x)
outliers<-function(x){
IQR <- quantile(x, probs=c(.25, .75), na.rm = T)
ext <- quantile(x, probs=c(.05, .95), na.rm = T)
H <- 1.5 * IQR(x, na.rm = T)
x[x < (IQR[1] - H)] <- ext[1]
x[x > (IQR[2] + H)] <- ext[2]
return(x)}
numeric_cols <-names(Ozone)
# Solo variables numeric
numeric_cols <-names(Ozone)[sapply(Ozone, is.numeric)]
numeric_data<-Ozone[,names(Ozone)%in% numeric_cols]
View(numeric_data)
Ozone_IQR<- data.frame(sapply(numeric_data,outliers))
ggplot(numeric_data,aes(x=V13))
ggplot(numeric_data,aes(x=V13))+
geom_boxplot()
ggplot(Ozone_IQR,aes(x=V13))+
geom_boxplot()
median(numeric_data$V13)
mean(numeric_data$V13)
mean(Ozone_IQR$V13)
numeric_data[350,"V13"] <- 500
mean(numeric_data$V13)
mean(Ozone_IQR$V13)
outliers<-function(x){
IQR <- quantile(x, probs=c(.25, .75), na.rm = T)
H <- 1.5 * IQR(x, na.rm = T)
x[x < (IQR[1] - H)] <- NA
x[x > (IQR[2] + H)] <- NA
return(x)}
numeric_cols<-names(Ozone)[sapply(Ozone, is.numeric)]
numeric_data<-Ozone[,names(Ozone)%in% numeric_cols]
outliers_missing <-data.frame(sapply(numeric_data,outliers))
Ozone_knn<-knnImputation(outliers_missing)
ggplot(numeric_data,aes(x=V13))+
geom_boxplot()
ggplot(outliers_missing,aes(x=V13))+
geom_boxplot()
mean(numeric_data$V13)
mean(Ozone_IQR$V13)
mean(outliers_missing$V13)
mean(outliers_missing$V13,na.rm = T)
mean(numeric_data$V13)
View(Ozone_knn)
View(outliers_missing)
x <- c(1,2,5,8,9,NA)
is.na(x) # devuleve una respuesta de tipo buleana donde TRUE muestra la presencia de NA's
which(is.na(x)) # posición de los valores perdidos
data(algae)
glimpse(algae)
is.na(algae)
which(is.na(algae))
sum(is.na(algae))
which(is.na(algae[,]))
which(is.na(ncol(algae)))
sum(is.na(algae))# suma de valores perdidos dentro de la data
algae %>%
is.na() %>%
reshape2::melt() %>%
ggplot(aes(Var2, Var1, fill=value)) +
geom_raster() +
coord_flip() +
scale_y_continuous(NULL, expand = c(0, 0)) +
scale_fill_grey(name = "",
labels = c("Present",
"Missing")) +
labs(title = "Valores perdidos",
x="Observaciones",
y="Varibales")+
theme(axis.text.y  = element_text(size = 10))
sapply(algae,function(x){sum(is.na(x))}) # número de NA´s en la columnas
round((apply(apply(X = algae,MARGIN = 2,FUN = is.na )
,MARGIN=2,FUN=sum)/nrow(algae))*100,2)
data.cleaning <- algae[!is.na(algae$Chla),]
complete.cases(algae)
data.cleaning2 <- algae[complete.cases(algae),]
mean(algae$Chla,na.rm = T)
algae$Chla_mean <- impute(algae$Chla, mean)
algae$Chla_random <- impute(algae$Chla,random)
algae$Chla_random <- impute(algae$Chla,'random')
median(algae$Chla,na.rm = T)
algae$Chla_median <- impute(algae$Chla,median)
which(is.na(algae$Chla))
algae[56,]
### 1.1.2. Paquete mice
misDf<-misDf<-algae[,colSums(is.na(algae))>0]
misDf
missmap(misDf)
### 1.1.2. Paquete mice
algae <- algae<-algae[,colSums(is.na(algae))>0]
imputed_Data <- mice(algae, m=5, maxit = 50, method = 'pmm', seed = 500)
algae_mice <- complete(imputed_Data,2)
sapply(algae_mice,function(x){sum(is.na(x))})
algae_mice[56,]
### 1.1.1. Paquete DWwR
algae_knn<-knnImputation(algae)
sapply(algae_mice,function(x){sum(is.na(x))})
### 1.1.2. Paquete mice
algae<-algae[,colSums(is.na(algae))>0]
imputed_Data <- mice(algae, m=5, maxit = 8, method = 'pmm', seed = 500)
algae[,colSums(is.na(algae))>0]
algae_mice <- complete(imputed_Data,2)
sapply(algae_mice,function(x){sum(is.na(x))})
algae_mice[56,]
### 1.1.1. Paquete DWwR
algae_knn<-knnImputation(algae)
sapply(algae_mice,function(x){sum(is.na(x))})
data (Ozone, package="mlbench")
glimpse(Ozone)
sapply(Ozone,function(x){sum(is.na(x))})
data (Ozone, package="mlbench")
ne, package="mlbench")
sapply(Ozone,function(x){sum(is.na(x))})
outliers<-function(x){
IQR <- quantile(x, probs=c(.25, .75), na.rm = T)
ext <- quantile(x, probs=c(.05, .95), na.rm = T)
H <- 1.5 * IQR(x, na.rm = T)
x[x < (IQR[1] - H)] <- ext[1]
x[x > (IQR[2] + H)] <- ext[2]
return(x)}
# Solo variables numeric
numeric_cols <-names(Ozone)[sapply(Ozone, is.numeric)]
numeric_data<-Ozone[,names(Ozone)%in% numeric_cols]
Ozone_IQR<- data.frame(sapply(numeric_data,outliers))
ggplot(numeric_data,aes(x=V13))+
geom_boxplot()
ggplot(Ozone_IQR,aes(x=V13))+
geom_boxplot()
sapply(Ozone,function(x){sum(is.na(x))})
sapply(Ozone_IQR,function(x){sum(is.na(x))})
mean(numeric_data$V13)
mean(Ozone_IQR$V13)
algae<-algae[,colSums(is.na(algae))>0]
Ozone_IQR<-Ozone_IQR[,colSums(is.na(Ozone_IQR))>0]
Ozone_knn<-knnImputation(outliers_missing) # metodo knn
Ozone_knn<-knnImputation(Ozone_IQR) # metodo knn
sapply(Ozone,function(x){sum(is.na(x))})
sapply(Ozone_knn,function(x){sum(is.na(x))})
outliers<-function(x){
IQR <- quantile(x, probs=c(.25, .75), na.rm = T)
H <- 1.5 * IQR(x, na.rm = T)
x[x < (IQR[1] - H)] <- NA
x[x > (IQR[2] + H)] <- NA
return(x)}
numeric_cols<-names(Ozone)[sapply(Ozone, is.numeric)]
numeric_data<-Ozone[,names(Ozone)%in% numeric_cols]
outliers_missing <-data.frame(sapply(numeric_data,outliers))
# Gráfico con data normal
ggplot(numeric_data,aes(x=V13))+
geom_boxplot()
ggplot(outliers_missing,aes(x=V13))+
geom_boxplot()
# Imputar valores NA
outliers_missing<-outliers_missing[,colSums(is.na(outliers_missing))>0]
Ozone_knn<-knnImputation(outliers_missing)
mean(numeric_data$V13)
Ozone_knn<-knnImputation(outliers_missing)
sapply(Ozone_knn,function(x){sum(is.na(x))})
mean(numeric_data$V13)
mean(outliers_missing$V13,na.rm = T)
mean(Ozone_knn$V13,na.rm = T)
mean(numeric_data$V13)
mean(Ozone_knn$V13,na.rm = T)
data(algae)
glimpse(algae)
### 1.1.2. Paquete mice
algae<-algae[,colSums(is.na(algae))>0]
imputed_Data <- mice(algae, m=5, maxit = 8, method = 'pmm', seed = 500)
algae_mice <- complete(imputed_Data,2)
sapply(algae_mice,function(x){sum(is.na(x))})
algae_mice[56,]
### 1.1.2. Paquete mice
algae<-algae[,colSums(is.na(algae))>0]
imputed_Data <- mice(algae, m=5, maxit = 8, method = 'pmm', seed = 500)
algae_mice <- complete(imputed_Data,2)
sapply(algae_mice,function(x){sum(is.na(x))})
algae_mice <- algae[,names(algae)%in% algae_mice]
### 1.1.2. Paquete mice
algae<-algae[,colSums(is.na(algae))>0]
imputed_Data <- mice(algae, m=5, maxit = 8, method = 'pmm', seed = 500)
algae_mice <- complete(imputed_Data,2)
sapply(algae_mice,function(x){sum(is.na(x))})
data(algae)
